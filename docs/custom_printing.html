<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Custom Printing with printing.py</title>
        <link rel="stylesheet" href="http://leo-editor.github.io/blog/theme/css/main.css" />
        <link href="http://leo-editor.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Leo Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://leo-editor.github.io/blog/">Leo Blog </a></h1>
                <nav><ul>
                    <li class="active"><a href="http://leo-editor.github.io/blog/category/plugins.html">plugins</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://leo-editor.github.io/blog/custom_printing.html" rel="bookmark"
           title="Permalink to Custom Printing with printing.py">Custom Printing with printing.py</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-09-20T00:00:00+02:00">
                Published: Fri 20 September 2013
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://leo-editor.github.io/blog/author/jacob-peck.html">Jacob Peck</a>
        </address>
<p>In <a href="http://leo-editor.github.io/blog/category/plugins.html">plugins</a>.</p>
<p>tags: <a href="http://leo-editor.github.io/blog/tag/plugins.html">plugins</a> </p>
</footer><!-- /.post-info -->      <p>Printing with the printing.py plugin is fairly simple, and decently flexible.  However, sometimes you want more fine-grained control over the output of your print job.  For these situations, you can use a script.</p>
<div class="section" id="step-0-get-your-imports-right">
<h2>Step 0: Get your imports right</h2>
<p>We'll be using stuff from PyQt for this, specifically QtGui.  Be sure to import them at the top of your script:</p>
<pre class="literal-block">
from PyQt4 import QtGui
</pre>
</div>
<div class="section" id="step-1-creating-your-document">
<h2>Step 1: Creating your Document</h2>
<p>Printing in Leo is handled by PyQt, which provides nice tools for printing QTextDocuments, which are in turn just HTML documents wrapped in a special object.</p>
<p>To that effect, we create our document (what follows is just a minimal example):</p>
<pre class="literal-block">
mydoc = '''
&lt;html&gt;
&lt;h1&gt;Hello!&lt;/h1&gt;
&lt;p&gt;Documents to be printed in Leo are just HTML documents, wrapped up in a QTextDocument object.&lt;/p&gt;
&lt;/html&gt;
'''
</pre>
<p>Note that the above string can be <em>any</em> valid HTML.</p>
<p>And then we wrap it in a QTextDocument:</p>
<pre class="literal-block">
qtextdoc = QtGui.QTextDocument()
qtextdoc.setHtml(mydoc)
</pre>
</div>
<div class="section" id="step-2-print-it">
<h2>Step 2: Print it!</h2>
<p>Finally, we use the printing.py plugin to preview the document to be printed:</p>
<pre class="literal-block">
c.thePrintingController.print_preview_doc(qtextdoc)
</pre>
<p>You can see how the document would look when printed, and if you're satisfied, you can click on the print button from here.  If not, close the dialog, and nothing will be printed.  Easy as pie!</p>
</div>
<div class="section" id="the-full-script">
<h2>The full script</h2>
<p>Here's the full script:</p>
<pre class="literal-block">
&#64;language python
 from PyQt4 import QtGui

 mydoc = '''
 &lt;html&gt;
 &lt;h1&gt;Hello!&lt;/h1&gt;
 &lt;p&gt;Documents to be printed in Leo are just HTML documents, wrapped up in a QTextDocument object.&lt;/p&gt;
 &lt;/html&gt;
 '''

 qtextdoc = QtGui.QTextDocument()
 qtextdoc.setHtml(mydoc)

 c.thePrintingController.print_preview_doc(qtextdoc)
</pre>
</div>
<div class="section" id="optional-stylesheets">
<h2>Optional: Stylesheets</h2>
<p>QTextDocuments can be styled by CSS stylesheets, if you desire.  You can incorporate those with a call to qtextdoc.setDefaultStyleSheet, which takes in a string.  For example:</p>
<pre class="literal-block">
css = '''
h1 {color: #f00}
p {color: #0f0}
'''
qtextdoc.setDefaultStyleSheet(css)
</pre>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://leoeditor.com/">Leo project website</a></li>
                            <li><a href="https://groups.google.com/forum/?fromgroups#!forum/leo-editor">Leo community mailing list</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://leo-editor.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>